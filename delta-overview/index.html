
<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://haruband.github.io/js/theme.min.js" integrity="sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1"></script>
  <link rel="stylesheet" href="https://haruband.github.io/abridge.css?h=98ebdf6fd3d59dfb2edf" />
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="base" content="https://haruband.github.io" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#333333" />
  <meta name="msapplication-TileColor" content="#333333" />
  <link rel="manifest" href="https://haruband.github.io/manifest.min.json" />
  <link rel="mask-icon" href="https://haruband.github.io/safari-pinned-tab.svg" color="#ff9900" />
  <link rel="icon" type="image/svg+xml" href="https://haruband.github.io/favicon.svg" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://haruband.github.io/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://haruband.github.io/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://haruband.github.io/favicon-16x16.png" />
  <link rel="alternate" type="application/atom+xml" title="CodeBook Atom Feed" href="https://haruband.github.io/atom.xml" />
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <title>[Delta] 델타로그 분석 | CodeBook</title>
  <meta name="author" content="Inhyeok Kim" />
  <meta name="copyright" content="CodeBook" />
  <meta name="description" content="Haruband&#x27;s TechBlog" />
  <link rel="canonical" href="https://haruband.github.io/delta-overview/" />
  <meta name="keywords" content="Arrow, Datafusion, Kubernetes" />
  <meta name="google-site-verification" content="Your Google Site verification code." />
  <meta name="msvalidate.01" content="Your Bing Site verification code." />
  <meta property="og:url" content="https://haruband.github.io/delta-overview/" />
  <meta name="twitter:url" content="https://haruband.github.io/delta-overview/" />
  <meta property="og:description" content="Haruband&#x27;s TechBlog" />
  <meta name="twitter:description" content="Haruband&#x27;s TechBlog" />
  <meta property="og:title" content="[Delta] 델타로그 분석 | CodeBook" />
  <meta name="twitter:title" content="[Delta] 델타로그 분석 | CodeBook" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://haruband.github.io/banner.png" />
  <meta property="og:image" content="https://haruband.github.io/banner.png" />
  <meta property="og:site_name" content="CodeBook" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:updated_time" content="2022-01-05" />
  <meta name="twitter:site" content="@your-user-name" />
  <meta name="twitter:creator" content="@your-user-name" />
  <script defer src="https://haruband.github.io/js/abridge.min.js?h=e0f9a881a665c86cce9c" integrity="sha384-QF67y7RnPkuDrJNQqn3/7nYxqxWkW/qHI7zN0WTES1aXbf+TotoByRBb835fUE6U"></script>
  <noscript><link rel="stylesheet" href="https://haruband.github.io/nojs.css" /></noscript>
</head>
<body>
  <header>
    <nav>
      <div><big><a href="https://haruband.github.io" title="CodeBook">CodeBook</a></big></div>
      <div>

        <div>
          <ul><li><a class="s110" href="https://haruband.github.io/archive/"> Posts </a></li><li><a class="s110" href="https://haruband.github.io/tags/"> Tags </a></li><li><i type="reset" id="mode" class="js svgs adjust"></i></ul>
        </div>

        <div>
          <div>
            <form autocomplete=off class="js" name="goSearch" id="searchbox">
              <div class="searchd">
                <input id="searchinput" type="text" placeholder="Search" title="Search" />
                <button type="submit" title="Search" class="svgs svgm search"></button>
              </div>
              <div class="results"><div id="suggestions"></div></div>
            </form>
          </div>
        </div>

      </div>
    </nav>
  </header>
  <main>
    <article>
      <h1><a href="https://haruband.github.io/delta-overview/">[Delta] 델타로그 분석</a></h1>

      <span class="s95"> Inhyeok Kim <span class="rpad"></span> January 05, 2022 <span class="rpad"></span>Updated: January 05, 2022 <span class="rpad"></span> #<a href="https://haruband.github.io/tags/delta/">Delta</a> </span>

    
        <div class="block">
      <div class="blockdiv">
        <a class="b s150" href="https://haruband.github.io/tags/delta/">Delta (Series)</a><br>
            <a class="scur" href="https://haruband.github.io/delta-overview/">[Delta] 델타로그 분석</a><br> 
          
            <a href="https://haruband.github.io/delta-optimize/">[Delta] 델타로그 최적화</a><br>
            <a href="https://haruband.github.io/delta-filtering/">[Delta] 읽기 성능 최적화</a><br>
            <a href="https://haruband.github.io/delta-checkpoints/">[Delta] 델타로그 체크포인트 분석</a><br>
            <a href="https://haruband.github.io/delta-cleanup/">[Delta] 델타로그 CleanUp 문제 분석</a><br>
      </div>
    </div>


<p>스파크로 유명한 데이터브릭스에서 몇 년전에 공개한 델타레이크(DeltaLake)라는 기술은 데이터레이크와 데이터웨어하우스의 장점을 합친 레이크하우스 아키텍처의 핵심 기술이다. 이는 기존에 (기술적인/비용적인 한계로 인해) 원시 데이터는 데이터레이크에, 가공 데이터는 데이터웨어하우스에 저장하던 방식을 원시/가공 데이터 모두를 하나의 레이크하우스에 저장하는 방식으로 개선하여 효율적으로 빅데이터 플랫폼을 구축 및 관리할 수 있게 만들고 있다. 오늘은 데이터브릭스에서 레이크하우스의 핵심 기술로 개발하고 있는 델타레이크의 가장 중요한 부분인 델타로그(DeltaLog)에 대해 간단히 살펴보도록 하자.</p>
<p>레이크하우스를 한 마디로 표현하면 ACID(Atomic, Consistent, Isolated, Durable)를 지원하는 데이터레이크라고 볼 수 있다. 즉, 데이터레이크에서 주로 사용하는 저렴한 스토리지를 이용하여 데이터웨어하우스만의 장점인 ACID 를 지원하는 것이 핵심이다. 그럼 어떻게 일반적인 스토리지 위에서 안정적인 트랜잭션을 지원할 수 있는 것일까? 그 해답이 바로 델타로그이다.</p>
<p>델타레이크는 한 번의 쓰기 작업에서 반드시 하나의 로그 파일을 생성한다. 파티셔닝이나 파일당 크기 제한 등으로 인해 여러 개의 데이터 파일이 생성되더라도 해당 쓰기 작업의 모든 행위(Action)는 하나의 로그 파일에 함께 기록된다. 간단한 예제를 통해 조금 더 자세히 살펴보자.
(두 개 이상의 쓰기 작업에서 문제없이 동시에 로그 파일을 생성하기 위해서는 스토리지에서 PutIfAbsent 기능을 반드시 제공해야 한다.)</p>
<p>아래는 스파크로 개발한 간단한 예제 프로그램을 실행한 결과이다. 보이는 것처럼 한 번의 쓰기 작업에 총 6 개의 데이터 파일과 1 개의 로그 파일이 생성되었다. 스파크는 익스큐터(Executor)에서 각각 데이터 파일을 생성 후 파일의 경로를 드라이버(Driver)에게 전송한다. 그리고 드라이버는 익스큐터로부터 모든 데이터 파일의 경로를 수집한 다음, 하나의 로그 파일을 생성한다. (델타레이크는 모든 로그 파일을 _delta_log 폴더 아래에 생성한다.)</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">_delta_log:</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000000.json</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">year</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">2000/gender=female:</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">part-00006-26150ffe-fdf8-4c02-9d85-01b90ee89a1f.c000.snappy.parquet</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">part-00008-b15e93a7-b28b-4cf3-83ff-6801ee091dfe.c000.snappy.parquet</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">year</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">2000/gender=male:</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">part-00001-cbe08f85-1931-41ad-b717-801b41be7365.c000.snappy.parquet</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">part-00003-56fab23c-5a87-4ed7-8834-b96d866d9e9f.c000.snappy.parquet</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">part-00004-a0465a5a-6592-4dde-a8c3-8716462d8d90.c000.snappy.parquet</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">year</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">2020/gender=female:</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">part-00009-1d1c1c04-838f-407e-b722-6a46d4a8c992.c000.snappy.parquet</span></span>
</span></code></pre>
<p>아래는 위의 로그 파일의 내용이다. 다른 내용은 생략하고, 총 6 개의 데이터 파일이 추가(add)되었다는 내용만 남겨두었다.</p>
<pre data-lang="json" class="language-json z-code"><code class="language-json" data-lang="json"><span class="z-source z-json">...
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=male/part-00001-cbe08f85-1931-41ad-b717-801b41be7365.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>male<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1221</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665794476795</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>James<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Smith<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:3000},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>James<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Smith<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:3000},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=male/part-00003-56fab23c-5a87-4ed7-8834-b96d866d9e9f.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>male<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1228</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665794476795</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Michael<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Rose<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4000},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Michael<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Rose<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4000},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=male/part-00004-a0465a5a-6592-4dde-a8c3-8716462d8d90.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>male<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1249</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665794476795</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Robert<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Williams<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4000},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Robert<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Williams<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4000},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=female/part-00006-26150ffe-fdf8-4c02-9d85-01b90ee89a1f.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>female<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1248</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665794476796</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Maria<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Anne<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Jones<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4000},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Maria<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Anne<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Jones<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4000},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=female/part-00008-b15e93a7-b28b-4cf3-83ff-6801ee091dfe.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>female<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1248</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665794476795</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Jennifer<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Cherry<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4200},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Jennifer<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Cherry<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:4200},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2020/gender=female/part-00009-1d1c1c04-838f-407e-b722-6a46d4a8c992.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2020<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>female<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1234</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665794476795</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Jen<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Mary<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Brown<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:-1},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Jen<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Mary<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Brown<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:-1},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json">...
</span></code></pre>
<p>그리고 기존 데이터를 삭제하거나 변경하면 어떻게 될까? 이것 또한 간단하다. 아래는 기존 데이터를 변경했을 때 추가로 생성된 로그 파일의 내용이다.</p>
<pre data-lang="json" class="language-json z-code"><code class="language-json" data-lang="json"><span class="z-source z-json">...
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>remove<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=male/part-00001-cbe08f85-1931-41ad-b717-801b41be7365.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>deletionTimestamp<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665795385572</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>extendedFileMetadata<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>male<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1221</span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>path<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year=2000/gender=male/part-00001-53b311c3-d70e-495e-9868-82b4fc8c1ed9.c000.snappy.parquet<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>partitionValues<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>year<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>2000<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>gender<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>male<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>size<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1221</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>modificationTime<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">1665795383719</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>dataChange<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span></span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>stats<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span></span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">&quot;</span>{<span class="z-constant z-character z-escape z-json">\&quot;</span>numRecords<span class="z-constant z-character z-escape z-json">\&quot;</span>:1,<span class="z-constant z-character z-escape z-json">\&quot;</span>minValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>James<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Smith<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:3000},<span class="z-constant z-character z-escape z-json">\&quot;</span>maxValues<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>James<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span><span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:<span class="z-constant z-character z-escape z-json">\&quot;</span>Smith<span class="z-constant z-character z-escape z-json">\&quot;</span>,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:3000},<span class="z-constant z-character z-escape z-json">\&quot;</span>nullCount<span class="z-constant z-character z-escape z-json">\&quot;</span>:{<span class="z-constant z-character z-escape z-json">\&quot;</span>firstname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>middlename<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>lastname<span class="z-constant z-character z-escape z-json">\&quot;</span>:0,<span class="z-constant z-character z-escape z-json">\&quot;</span>salary<span class="z-constant z-character z-escape z-json">\&quot;</span>:0}}<span class="z-punctuation z-definition z-string z-end z-json">&quot;</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span><span class="z-source z-json">...
</span></code></pre>
<p>마찬가지로 다른 내용은 생략하고, 기존 데이터 파일은 삭제(remove)되고 변경된 데이터 파일이 추가(add)되었다는 내용만 남겨두었다.</p>
<p>이처럼 쓰기 작업은 간단하지만, 모든 로그 기반 시스템이 그렇듯이, 읽기 작업은 간단하지 않다. 기본적으로 모든 로그 히스토리를 순차적으로 분석해서 마지막 상태 정보를 담고 있는 스냅샷(Snapshot)을 만드는 작업이 필요한데, 쓰기 작업이 반복될수록 로그 파일이 많아져서 스냅샷을 만드는 작업이 점점 더 오래 걸릴 수 밖에 없어진다. 이 문제를 개선하기 위해 델타레이크는 체크포인트(Checkpoint)라는 기능을 제공한다. 이는 간단히 말하면 해당 시점까지의 모든 로그를 가지고 있는 하나의 파일(Parquet)을 만드는 것이다.</p>
<p>아래는 25 번의 쓰기 작업이 실행된 결과이다. 0~24 까지 총 25 개의 로그 파일이 생성되었지만, 10 번마다 체크포인트 파일이 추가된걸 볼 수 있다. 델타레이크는 10 의 배수에 해당하는 로그 파일을 쓸 때 과거 모든 기록을 담고 있는 체크포인트 파일도 같이 추가한다. 그래서 총 2 개의 체크포인트 파일이 보이고, _last_checkpoint 파일은 마지막에 생성한 체크포인트의 번호를 가지고 있다.</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">_delta_log:</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000000.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000001.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000002.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000003.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000004.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000005.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000006.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000007.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000008.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000009.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000010.checkpoint.parquet</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000010.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000011.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000012.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000013.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000014.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000015.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000016.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000017.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000018.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000019.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000020.checkpoint.parquet</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000020.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000021.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000022.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000023.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">00000000000000000024.json</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">_last_checkpoint</span></span>
</span></code></pre>
<p>정리하면, 델타레이크에서 읽기 작업시 스냅샷을 만드는 과정은 아래와 같다.</p>
<ol>
<li>_last_checkpoint 파일에서 마지막 체크포인트 번호를 가져온다.</li>
<li>마지막 체크포인트 파일을 읽는다.</li>
<li>마지막 체크포인트 파일 이후에 생성된 로그 파일들을 읽는다.</li>
</ol>
<p>그래서 로그 파일이 아무리 많이 쌓이더라도 스냅샷을 만들 때 필요한 파일은 최대 11 개뿐이다. (_last_checkpoint, checkpoint file, x1~x9.json files)</p>
<p>지금까지 델타레이크에서 델타로그가 어떻게 사용되고 있는지 살펴보았다.</p>

      <nav>
        <div>
          <a href="https://haruband.github.io/delta-optimize/">&#8249; [Delta] 델타로그 최적화</a>
        </div>
        <div>
          <a href="https://haruband.github.io/ebpf-loading-jit/"> [eBPF] BPF 실행파일 로딩 과정 분석 (JIT) &#8250;</a>
        </div>
      </nav>
    </article>

    <div class="sblock">
      <div class="blockdiv">
        <a class="b s150" href="https://haruband.github.io/tags/delta/">Series</a><br>
            
      <a class="scur" href="https://haruband.github.io/delta-overview/">[Delta] 델타로그 분석</a><br>
    
            
      <a href="https://haruband.github.io/delta-optimize/">[Delta] 델타로그 최적화</a><br>
            
      <a href="https://haruband.github.io/delta-filtering/">[Delta] 읽기 성능 최적화</a><br>
            
      <a href="https://haruband.github.io/delta-checkpoints/">[Delta] 델타로그 체크포인트 분석</a><br>
            
      <a href="https://haruband.github.io/delta-cleanup/">[Delta] 델타로그 CleanUp 문제 분석</a><br>
      </div>
  </main>
  <footer>
    <div class="c">
      <nav class="tpad"><div><a href="https://www.linkedin.com/in/inhyeok-kim-7620a0b0/" target="_blank" title="LinkedIn"><i type="Button" class="svg linkedin" title="LinkedIn"></i></a><a href="https://github.com/haruband/" target="_blank" title="Github"><i type="Button" class="svg github" title="Github"></i></a></div></nav>
      <nav class="vpad">
        <a class="rpad s90" href="https://haruband.github.io/about/"> About </a>
        <a class="rpad s90" href="https://haruband.github.io/contact/"> Contact </a>
      </nav>
      <p class="s80"> &copy; <span id="year">2025</span> CodeBook</p>
      <p class="s80">Powered by <a href="https://www.getzola.org/" target="_blank">Zola</a> & <a href="https://github.com/jieiku/abridge/" target="_blank">Abridge</a></p>
    </div>
  </footer><span class="topout">
<span class="topleft"> </span><a href="#" class="top" title="Back to Top"><i class="svgs svgh angu"></i></a>
</span>
</body>
</html>
